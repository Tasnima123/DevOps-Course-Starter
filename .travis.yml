language: generic
services:
- docker
before_install:
- docker build --target test --tag my-test-image .
script:
- docker run --env-file .env.test my-test-image tests/int_unit
- docker run -e FLASK_APP=todo_app/app -e FLASK_ENV=development -e FLASK_SKIP_DOTENV=True -e MONGO_URL -e MONGO_USER -e MONGO_PASSWORD -e MONGO_DB -e MONGO_PROTOCOL -e MONGO_COLLECTION -e client_id -e client_secret -e disable_login=False -e redirect_uri -e MONGODB_CONNECTION_STRING my-test-image tests/e2e
- echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
- docker build --target production --tag $DOCKER_USERNAME/my-test-image:latest .
deploy:
  provider: script
  script: bash webhook.sh
env:
  global:
  - secure: y1nfDSfF3/+vTpk32GC771VY7mcBz84DH7qDlJRzr7TtKSL0/Ya8XhBgmsu5FZ4buwSrzc3Ua3r9t8SyXXC7tCXO4S+eYlIDmq8do9XK0Np+4GNqERuNqY+fq6pDxJHf3SL3n7U/U5L97uJKAOXyCjSDOTlDOTJ9fgf8BZ7nxYCwu+4Xzc5VYN7hNde/GWeAUaiSxPBPnziNBVW+JwJqoafOjMGo1SAFxp4tl16SZLZbpSigF+iTeLF2w80ZNdqgmkiH7SY2Jv8nART7DnkifCTL68PBz95AX3sbUjCHGxU61NS7IJBMxeYbQGbjZIQFJH0c2MqfCsV1Qqc5KicVMkqAvjvIFmpuz1FVWVyfbn+QAUzX9fqvzxK0ViT8Y62Zw4kd7EQwL9VzWXlqNYUAI1uAvEqp0YZLyioFZzd5w5UrYKzf0jNau0duOm/ShN+ggbhZ/LpkogahCuQrwkFPpk4SNevkdvk8yIWZgjnGPATgxD25C2wGStH+es7jwxfrT1oQSGvPmIVkkMq7HdZ56KB/uvSJK28zwLFmYgvzZK28zlST5W0Fhhs6CDNG57GvqE0obTtDE83bLfxYw++lKnzOvgMiJboJM4YdZj9gDr4smjpoEDwOXh6po4Nu4+uLKOsf6R8A0bQtFjBrWVGN93abJV/U+SyDlcSvIVSxuAQ=
  - secure: SqWtfkrApujjHus5KaHOxfd+eI7ek6pp/BkzTy+ezkf6JKn0VrCa3+S4mf0FvdPu7rhh6jgSD4VY8n4ondGHFmWhh7vkor13kt926xkajHkvPyp7CLev4oZ0Xd9/pR1ftVOHe5/+E+GFBcldLITm0tud8/XSSWEBNHIbMbasNNwvSQLFIRUBDE5dqoPCE9YIQ7WVmMP9L0Gk2/U0wzxdIpUbItrYrc0bpbaNJioLFrW9S5FsMQ8IiKzFMj72ienm9Oj48itOkji5oZpiaHAQevcL+0trLdwDQH0O8aosMT/J/yPMXmoe+3raVfyH/qxscrLTx24JPnyYmz9DEcbABske4sA6rXCHowRK8L4qHRytkikKSNLvQFO915Z8NuVc5D1bK41Zkyt2w0Y4Wca7sCvDx3/Kpkn7zDpc2DhiALe+ABZscx5NPiu+Nu4oBxX9c9lQM6RhRKeMFw7ex0yQihDldYDZCu2aEs102roF7uNrN1NF+z/LxfhIDkqqM9G8aumKd70zklh3dAqAvjO821OMQq3RlqlJ9hB8569VvGJ98wC2GL1XMcQLQo6J2OiboIOiRX8sEaPrmQ6lp/MQ/PRtKTsYX7xJV+/BXUbFOBVQ7mDkHJfv/FMtWENvl/Q/f6OXV4B5SWMXSbVML5Dw3UsfTlhul57bMJoq+9Tx4so=
  - secure: xdWZ7kum+bLzZBXF/7FEQ9+izyYWy1iN2VXVY5n0Uol0KHdoKd9ocHeXWrO98YVl5P2bKfFvr2BamF8vkesbeJurla0i6cxmuWYowA3zqLaVopYDwugi+trsGumD0ulIH3AjrM22GW+LNiRZzHvPkMGB4l4I5+gFy/jIP+k7Q5judTRFMkZH8bvxYOGH0+te4O22Z2h0mULbjlIOkpoX4/iecZibqMR6q3psBs1uwv40x4vmtgVsTGFkHr8GBmLEPSGFmhXE5RC7Zu1m9R68i6mOuPxcWfgmywi7uv1TN1Ic8KJYyvxW33uwvIRWTOMf9NPLAXqF2LgcbO6Qtkeu68Ed/FmOpXrwmbgCyo5eRS0LWWMxrI4FgDJtcs5Di3vcrXl/BrtiIKnXw5+0CR3fEA3a4Ij2h1GFo8C/9wM+Qp+Txui8T6crs7KPT6WeXxd51Z0osOAz0rj2LT8D8P1Mht5m2A/nRponSn+mLLQRZmXY6dczNDqrhgh01adkqQs8YToPC6u24rozHVr/ugmptWfxI0HDeIHszWxYgd5THwN8KTy2J+q/cRs01Je41QhlICrEZ2qEPf6RAt9Oom3sewX1QJG9i/rAPIL3QjMK8Og81sKrObp+ezzvTOJRrDYZEnhLZyY1g3X4aO80wpiaFY65ioxLZbV+enMVjw1m7pg=
  - secure: WPOlAWrIMatSOVlncIChoZaz1lHqmwyYbO9eiyD4GEfAqy3MSdxahFz4dvsAGbP0U/blSk2T4q9gHgtZJ5LeaoyW+pfK5VmYIiKcBStTV8N4gh/uTRBwBu3Tmn59C8SBTnuC03BvKKygx7Gv2Njdmxjz0eZpI4uSjrv0bGJUwq/n5Va2pYN1W9dZC+BzX5qNrGSJZqh5JZ9qEuwjFGx6EGn3Aex5ard9YkBkfy3i0tAxQ+0aApZWNdhKz4OU1GNSpoa+pV9ntnG5R0EJsE6swwM9Xbi+KL/xOt8tzaD1KaJfm/IXymBT4xxhHwn5NkcEx7obROZG5Gv6oiHk7SsKGzwcSOQEF9Aw+6IoS8tZL5UTGINGdOKIu1p74GeZmvwEPchYEbTXlMDCxTZvLOJMjIf0bwg9t19zWPDlspLz+UJpH7Jc0emw/nYcGVSqiTo5fHSjfQw15D+yz6YcNdeQq7nosZZGHKe/w0z1Ar2vy28km1z35eXgdKxCTZtD3+oWFdkGjPFVo5KyT/cPGGmjkb48xS3PrC+V1uIcCnXW/qRCGoXvRTEdOz+hJymNpcDEStqnLWG5P7ydJ9PpbxUTEICanCIzvgxBCbT/XeX1Y5ghKNsaQ1dNpfD36PLhPlVQzMFFMk0LKW41AYSM8gE+oB2Q9ptbRLQHaoVUBNA0LLI=
  - secure: mjhsGFOrnyvtes9MgwhpyLoQn9l7f//+6y+zrz03pdvjpy13AyTcjIDwH5qMXGunx7CvfPv70mazwG4l22vT2cL/ti8s0duFkKlmhx8YnRAS+dnGJR5QyhgfFLnXNdiaIH6yLbFRfDz9O0Vkxnzk/OKqshBpM/fKdrMEyiynmDmTM0wgcMTwTAEINY6Fo+00llweF+31VtxnkW0FgwG9soJjSWR1qdmh5aPvuKHOM7z7d9t/DwWDiooZYmbmNKrOvjp8p3eRtDSNoLufbSVKgSIw/Cqa2c6rxHi69PcUa1RcMbx3ijeYQDKkcjj1pUMt7CrmEm2zA13BtZuE28v6IV1AEmKaL6LQA8HVB0Qxg27PKyTSKAlsUWJ0r8JvTUnOpAbT+Z2EGGPpBvYopn3NU6cGkDDQ80JTLUbbtlKBT+PcMCLanYCKPULz24v4wmxiymxu8xmyO1DjdR5d7hPIHT407ZInDNr5TfCOlsH8txKAEvJ5h2pP176LKDahbArcBkxSVKQgky21sB9K/x1MVYsiIACNdga2t5R0KEE5AWf+jWyxgZtCqaglHvKBU6XSi9HlhLTnjj181Ctm3QzWo0C7GpnAyw04WDOXFmeNFdeMupwcFLFv9X7j07XSU6W75hGqfqxBcQ6UfUlXv268j2PsuaPQTeb/xMWvzykj2YE=
  - secure: nZbK5ZUcOPPoquT3MXZRG5wXL7HtlPJzbr0diqZVxdr9uNUeDuBXDXuLYZqIMtnsErdEPqrSHJyE5yc1XP5HifdytSJOTmtylQlUWyHDglXPnowA7LBQMwycRZ4HLduIisZeMGmLjPjgWqesrUw5l57/u2JGZnjujrh76tgxCp3QQkWG1m6bvf7YmDrYpCx3LvJhu+0ZUegdZvE9dGS9nhSDdFHqLoyhikZ9UqXInEsZ6KgqGG6WmmDu2u1e9jC12BqjMMkOyrWBYkx0tHlo8UqwIG9gZhykvUlXnFz3P7lQwc3mVYC/FN5a8SU1gWesMNmmF6VfTeAOXK8SkxpPaykFKYHSb5/ZUfAmj3U69BBK1DDVRz58QZmngmcWvtkUokUjROfyomPSDjQSezd53xIb2prPN81FNiu32HkRr1asNlzwj93Q8nb5XknTEhk6EFbsKGn8yzzVJWkWLD6QTN/TkorJ4ZHBx6ZDCkXHBbk9wq5ea8l5koe2LtP97D4Q9vu5BFEksJXO5MHufLg45jJZoFKcw9vcA+Ebbrx5XyW0opHUwm6rCSy60sMdWnNlogdfomsrMx/gjjCQ4yOBzyYqhbjUHa8XKCMokdEPeZP+/AnhX0kc/WvYAL4wpJ+gOpO6r51XB7Gji3ICflFPsxhXArqwn6BzvA7t6Z0u7+o=
  - secure: FWpH/p6lXD9/M3fRnrB0sj48UlAs9wuaBtnXjUyB9kDzN9ajW2pSnHw1rZAhaq4iBvUEU0CTn8IAkrTAw94uGrbLK5Qkg5S5ycUMOCpcFWYlFGYmsmVywL6OdnekuRxdmJF7+HmqtSGWSb8NMu8zKZUyWiEjWykfaTzUBab+nJMtOIVRPg99Fm4GKoM5LzOAMukVE+bi+Ba1alxjaFwQRhtxwG67qC2ndHFpZd5Xu9Cu+38Fb5H8Sz9T69C6AMlypXJy68g3iVEIXJMwKOAOhLhHscaAGoZJHn61RA9OW24Wvoe9TVLUXsD/Poktv0DdgcgkrBv8W+XxpEHiqGXjUiHUGXirQeaDm0S8hm7gHQ7cH8ipLqSxxji3h70L46tbq6UID8VCGhCyNjxCszCPCg0Rh2eBE0iwCMntOH0nFG1Gtb9kusPDhs4MDwEkKYOgR57t7zGBJN40YZBku+7Ro0D0FUIRZUZLa6AtI942fysFsP4DWr1oxFsiYC+Tff9JztDouSMEojwRlKmDggNYY1zFBDNeOcJaZXm3mfVb4ebhTm4Xd9JOvGWoL0ECRoXrVt3v31NLzYih9jIIB9hpR8mRrLUh167N+biFKcstN5Q8Wk2sMYQTq/XFIbkB6SVvlyciytrMp6DfhdOFC4Rwok/aUqlpSPcNdrCDZonY+KQ=
  - secure: PH6GZBy9oSjediileQeHURwY7HbravoX/Wz/LLo6uPZPAl0gGmZ9tWNgPVqooIQf9I1OgOPp6BxcPOyqAhVKTQ7lQq4XZNNH8jDnVRNnJewbUkhnrNq9djW2ybG8ATXLTqmBNo8SkAetoFwmI1hL0WzWtPPrmebBrqTaEwL2QEqbLO3f59wdZ+OspVq/XqiTP1UpiIFkbph9LyDaW737txDl409g0bYpnrcil0qCRXP9YdUZ+960B8W0MeFu8bZvKNlOK6DDAqWerIan7A8rkX/2NADtE1Fx07nEi6b8kdJblg62bGd96ijJrNsRP6GIy9QH+A40VBelQMq89PPagUUsUWyE642HT5Y159Zmp19MmGmQta1+ziD17W7wi/7fzmIkUtqDGWN9cGh9oDOEW/DI1svPyW3JsKUmfFpoH+kNGa4Trf7mdhqKuD4Zc1ez00UZZtTQmummriqyR2VxnytH0iDQ1ZnImGGoBPHD7dSfDw8jmMpma9ShZOjfxkxmI3EM3QwzCKK214bEazMNo/GoPNVFMe1GDyvoZKQA979CSidUBT0NZqg31H4OFXOoLCldC0wolCTIrogwesSn7wg3uv057NEA9qa66gAg1Cl7hWbyjw6qsg/F2pq9FFov5DVKVWfTpxlnX4mZ+bwTM5K6xw+JLuPTfJqcGmwcP+k=
  - secure: CkKZL7ert+EzGbwlOk5OHeu1JDMbVUQsIRawUw1QHiBuIjXwIiWlF0OKyRdkTqtatUT89Be/WkHotHmBMd02l7b8JBs+zsSv/XmR1b0qEmZ9KxLKDSMd9AZgjsS45Ljz40m/NOdS+kxC4qYo0WVxXX6ueH00CiLPmQgpz7Y8HNGtUt+XJg5VEvLQnG6/NiUopjBk5+gvXu/A68ejfX//qeE0CO28NlW7XvVo2gcUe1tBW9sLJ+tAWDhZWAsEdH0V2j3EkDacCrn9BZUZtcOE43qxc+NEnbjHQ8JVdIUP7XWx9ERm6Bkt9fDK9KlsimRFGdXjlJXBLB4jIorsPVEptv13Klh2K3ABFYsHK5H95zqAO7nncotJMg/jLoR4TMTpC9IWm++AhF+Mh0fH+9k5Q8x+8JtRFieogK/InMu5z9dG1ibbsVRQyPp1cSV6viZhFQ/YazlMd/N4NwACJk3rKcsBjLxvkNQ+n1/o6C43eWEc42hronGE2QjBuu7VlS1moJx13MxVKrW34iQ/OQGdIS9VYmtZdVb+ILRPZFQllY4cUlhxUDvNb8LckETO4Ec+OPs+VPtbOxRtMLPfYHXQpZyqDWYfVZgURJjJeMtvtY4wFPtZ+QqbV2kYjyq5tjOwI8tSr6uSd/xKWTmFa+HkIcLlUisMOghECBFKBqflLR8=
  - secure: oj5KzOYQrKZDstHQ2yM6iZ7B/oS7nU7Q0nkIcrvytgOc7STPpYcygnd+p+nrY9ttcoF+IRYo9fBKHPxanW1CD/HFZK+/YbLPkaqEecOYGKbmXi/TmNWws5ElgCdwfCTy+B85DIdcpoIAEAY4rMhuIrB3GKtxmlu0zt4ip6yvfyPFHRkuyB169kRsjV0WVWZPXuLm1DQEkDShb0Ghj+we8yg4o3VcvFcmzGJw/XQaojEiAnBtQVArUsg0Bqp+t8dJ/wbzmlulpzct6nIRAmoeyisA4Kg8F0JodDCxrD20856c99HGVyOQvCNeJmwcdbdiDsdBML0EExabpir+6l7NeNdKWFRMyjc5UCiK9MMAk5dO8/0fCRqGsWGMu3c9wxYetIBLkk53AgryJTJ84hA+FiB/4f2OQQSA2fA9WH7cTTD8vPbE/0NstiWgXlfzleHNiKJi5EPSLH8egdI+oKblOcfvznLt6GYDDHCLVkqe7ICb/qkOujWB/T+xOwDmGSeaaSo5BJ+SvtYrdIOyTCnolxTHULGKgDRG0RMp/56hB8LDqBlNX4X4i9JQpwyHHVjOCerFPoZ2QVHDxUttbhC1yXC8acAmhqvXZUThecdggccxTeYTkcxYxB6crv6m7IpewD6XpcWwDjFoBuQx3ToK4HiBN6gR0dDrCmz5Ww4khSk=
  - secure: q4nKAuNfLi17lROklvxnim3RDvoPsNGiIxM/8ITzur8TXfYJxKu6QAHdctfLOsXlX7sP9w+ViewwZf4BcmOK+SnvwqItCI3ubX7qYQDibyeAWRlS5U3Ar1SazWKJwOeX9jC1Nhu7+8uHh0TMfwJtHccb3e+9AGSgVUjsJKUwuJenu+loPFpiO63u83pnOKgkQixyTBaP867jTleUuXGCq0Zdjo2tVu2pIsAE5yppnGEIuAo4LanCtuBUjdgD7IJvsEE+uIBuIOiDngKiQLVw43R6dU0ExJ7b76XJ/4wlh5wNygtCbn3F7bOMecouCmY/KviSlFLFkfhu7b1clawV4tyL2bGesWM++xGI9eD5zViiE8196PO2CD7NpL5ISO+9q9ceAkcha2zvRRzoO7T3RZ2BoWtMAx2tZKE9gGbhcziCan9hbDaeXR+9dKQYQjeShxEs2/+5QSDHt7/Sy5b8sX4Eptg0Pz9O6ZucNv7YetdZyUR7abqFqzmXEEhrHTA3/13tIKLK7Gty3TxEX7Ib6Rr8JWzo+J2DWLWzTacqNialAgThzhO0X7oRsrexoiJVpkvDo49JS05Zg83Oe8t8EmFk+72oslW4dE+yWtsYiT0ECsRlOSasKARgFvnplilRDokveuTQVJtsBdTW/XoZhiOG6syK9FCkktl8PRoxGTo=
  - secure: SOs03+4KQQr8tTr9pcylD9WAkMcJEfVtiG4E2DsgVwikX8CDgUbTLVhx9aoGsQ8q4gqGeiUyy0zG0zQDCaZuNN6Vfdf0db5FXBoHJ4hLHwm9KculQGe78v5eaoSoXds1/M4p9vQb8dNJrIytJ3Q7EjaRJ9e/GGrXPuM6tRs5WtvkcOm6LlqaS7wlNVShwPwEtlqXhUkn1b0JKFpsd7bEJQnm+GMnUGWDN2M/7+3i4GirBS8ms8AYjgQm1Ic8sYrLWqd1M0uw/Xje23GWW0vAtF7DFQ8EIV8D1Aumb4vW3YuOHoBG/Nlh6siHf+vrcw8ht/aEo9lY8GChlfz48T5FlxSfq5khSOmgDa2IdAnTBTaQboj9fqteRZhmLAd8UTtvJSooTatkl2mrPA+mSrl2UEpn7FiZmdkYsPkL+HZjfGdQHJ7fOq6uPwGs8iJT7KZnL00AlYCjADl8S2b4isTSGpV3bFCRYge2G7mAgeH0RnLpsiJIBArG26iAAEmL2uK22Wgve1raL25pOPFissc8ktCPAMgprM5gTjTpudFllXRgbNkqI6fOh0qskFCbBO6yaumcg1SYiuZvhp2Tb/b/orOwZCU3w8J3tyKwoggEQ7ih4ioLkI4ScyVRrQ+dj5yjCoU+BceCypQSSM/aL/tMDdntkohUWkWPDDKNypbFy4U=
  - secure: HEQyQmkcN+bwqi6lNi0hlqTX+rN3bG5VPKy3zhssY1OiSHUrdbLy8qSpqGPRM8/D7psRX4r5GyFW81JS6x0eo/cEetEb7I3xGr2NbzNR16PQxI7TdWUGB2ZAOC1n8P7/NIrY59KY+X6ZjSPydHv76LAlotyL/Ihwi9qS/EXc5MRSE4jVVbMFuxuYn8hKutR0v3it1JT0pVaCAEwM2GhYD9svFEhPFjO1GYYHu8lmD+PwlX8O6kCB4HCmsbPnVxiM8W4wyLtY7zd39BG+tbI2RO12V9ZUvTW0z4VmX+WJ7wZDq6NPT0F045MfXB0/+ZIyuirAorwr9kCtJAz1c9zXfimO1Vgdjo6B2CbVXn+VXabYvPxvR/duacy4r+ep+m2AT5NAIkcf0t7DZINCKz4W3Bsta90mPALGWIrQUYBkpB7gNb15LpsTSHsQkztqfj8tIA/B/MomWmOqNbc2Ef/ovGhg8q8xDi8Y7g4Mv7M1IMTWQ1krCcyzJBl3g1THSPHLDGzJWyHAHpJGo4wBwerZCSQqVS4eC/WvFBSyv6XTvi7zfkqLhqay7exaDzOdPqdtGFnGD/TG9Uo0nuG7Fk8gSn5px3oKpfeTDxKHv0jJL25I3RJuio2UjlV6yjHVSV2klgIm9AH9rN/uiCmNv2NWWUtdNL8x8ZA8inKPpUKFZvg=
  - secure: Wnn0vFtp2fWSfjmNIicp7NtepJ4Dr25E569NRt5BFSGLvZ2gvDXV0wJh1v+fmBCQ4vHqBDULwgG0BHZ9C4hBX8oHISarGmI3gAYQJasY2FXMlUhaW7l22M6+rFbbknJoNEE9FHpa0kMkRmiomGsVQFDyrQ4a0qX8pxDwKYaLDnuP5iDZ+uCiyI8iw+tHAxQfLySLHTNHs+taB/9hCKmnvBVWBDaiik1QVABSiJdlrlVLy3sh9AiRAwxP8yJrLHBTEr1Q4Y4r4qPYc9wdgo6vTemhmH9pV3r9gw3+B7v+fvKC7KHfpI09FHfCfrMKNrQaptglJRAXSaj34jJK5sls0KM/iNKWdEfbEGjn10Ov+BB4vSGscmQLZ7T3136NQKv4on+ub7zeLj+uXt6CxAzMGWIeQK2wjwtK0WDw66w4GzbHlpWBultEELSAd0u3q9xp+tEThxmpPapm9osEmKYb9eC9zNKCNH7w91poAOrwwiQYeeaWN9ae1JeVsI7Qt/fukOdVs0qarVT+kq6hhKSw702A116pzVKtxUbTLIFns6nfHn0R0NyAeFDmYDDrdtUU4Ja86FVUavswU6FftnuwGiHqT9G2Gy0WnLhKW9lhy4fczqDKctP+m0htQ7+hol9GDnbzTkTvroj/VIoAvh2zebXaTZnW/cT0su8mAK//kxU=